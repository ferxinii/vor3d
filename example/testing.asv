clear all

[v, f] = loadHull("build/prev.m");

trisurf(f, v(:,1), v(:,2), v(:,3), 'FaceColor', 'red', 'FaceAlpha', 0.3, 'LineWidth', 0.001);
hold on;
%%
[v, f] = loadHull("build/hole.m");

trisurf(f, v(:,1), v(:,2), v(:,3), 'FaceColor', 'Cyan', 'FaceAlpha', 0.3, 'LineWidth', 0.001);
hold on;

P = readmatrix("build/hole.txt");

scatter3(P(:,1), P(:,2), P(:,3), "green"); hold on;
P(:,4) = P(:,4)+1;

%%

k = readmatrix("build/visible.txt");
scatter3(v(k(:)+1,1), v(k(:)+1,2), v(k(:)+1,3), 'blue'); 

k = 132;
scatter3(v(k,1), v(k,2), v(k,3), 'red'); 

%%
P = readmatrix("build/test_circum.txt");

scatter3(P(2:end,1), P(2:end,2), P(2:end,3)); hold on;
scatter3(P(1,1), P(1,2), P(1,3), "red");

%%
[vb, fb] = loadHull("build/before.m");
[va, fa] = loadHull("build/after.m");

trisurf(fb, vb(:,1), vb(:,2), vb(:,3), 'FaceColor', 'Cyan', 'FaceAlpha', 0.3, 'LineWidth', 0.001);
hold on;
trisurf(fa, va(:,1), va(:,2), va(:,3), 'FaceColor', 'red', 'FaceAlpha', 0.3, 'LineWidth', 0.001);


P = readmatrix("build/test_intersect.txt");
for i = 1:size(P, 1)
    scatter3(P(i,1), P(i,2), P(i,3));
end

%%

clear all; close all; hold on;

files = dir("build/*.m");
files = files(2:end,:);

cmap = lines(numel(files));
for k = 1:numel(files)
    [V, F] = loadHull(fullfile(files(k).folder, files(k).name));
    trisurf(F, V(:,1), V(:,2), V(:,3), ...
        'FaceAlpha', 0.5, 'FaceColor', cmap(k,:));
    %pause;
end

axis equal; view(3);

P = readmatrix("build/test_spike.txt");
for i = 1:size(P, 1)
    scatter3(P(i,1), P(i,2), P(i,3));
    %scatter3(P(i,2), P(i,3), P(i,4), 36, cmap(P(i,1)+1, :)); hold on;
end


%%
function [vertices, faces] = loadHull(filename)
    run(filename);
end
